class FetchaJS{static LOADING_START=1;static LOADING_STOP=0;static MODE_LOCAL="local";static MODE_SERVER="server";static POSITION_TOP_LEFT="top-left";static POSITION_TOP_CENTER="top-center";static POSITION_TOP_RIGHT="top-right";static POSITION_BOTTOM_LEFT="bottom-left";static POSITION_BOTTOM_CENTER="bottom-center";static POSITION_BOTTOM_RIGHT="bottom-right";static POSITION_ARRAY=["top-left","top-center","top-right","bottom-left","bottom-center","bottom-right"];#a=null;#b=null;#c=null;#d=null;#e=0;#f=!1;#g=["pagination","server","language"];#h={mode:FetchaJS.MODE_LOCAL,template:"",data:"",server:{url:"",method:"GET",headers:"",body:"",total:null,then:null,error:null},pagination:{enable:!1,current:1,limit:20,total:null,buttonsCount:5,nextButton:!0,prevButton:!0,position:"bottom-right",activeClass:"fetchajs--active",commonClass:"fetchajs--pagination-button",server:null},language:{nextButton:"Suivant",prevButton:"Pr\xe9c\xe9dent"},loading:!0};constructor(a){if("object"!=typeof a)throw"FetchJS: Contructor parameter must be json. Giver: "+typeof a;this.#b=this.#i(a)}render(a){if(this.#c=document.getElementById(a),"object"==typeof this.#c&&null!=this.#c)this.#c.style.transition=".4s",this.#f=this.#b.mode==FetchaJS.MODE_SERVER,this.#a='<div id="fetchjs--loader"><div></div></div>',this.#c.innerHTML=this.#a,this.#j();else throw"FetchJS: Container not found"} #j(){if(this.setTemplate(this.#b.template)){if(this.#k(FetchaJS.LOADING_START),this.#b.mode==FetchaJS.MODE_SERVER&&this.#f){this.#l(this.#b.server),this.#f=!1;return}this.#k(FetchaJS.LOADING_STOP),this.#m(this.#c,this.#b.data,this.#b.template,this.#b.pagination.limit),this.#b.pagination.enable&&this.#n(this.#b.pagination)}else this.#k(FetchaJS.LOADING_STOP)}setCurrentpage(a){if(this.#b.pagination.current=a,this.#b.mode==FetchaJS.MODE_SERVER){if(this.#f=!0,null==this.#d&&(this.#d=this.#b.server.url),"function"==typeof this.#b.pagination.server){let b=this.#b.pagination.server;this.#b.server.url=b(this.#d,a,this.#b.pagination.limit)}else this.#b.server.url=this.#d+"?page="+a}this.#j()}getCurrentpage(){let a=this.#b.pagination.current;return a<1?1:a}setTemplate(a){return a.match(/(\w*)\.html$/)?(this.#o(a),!1):(this.#b.template!=a&&(this.#b.template=a),!0)}getTotal(){return this.#b.pagination.total} #p(m,n,L){let u=L;return void 0!==m[n]&&null!=m[n]&&(u=m[n]),u} #q(c){for(var h in c)(null===c[h]|| void 0===c[h]||""==c[h])&&delete c[h];return c} #o(M){fetch(M).then(a=>a.text()).then(a=>{this.#b.template=a,this.#j()})} #k(v=FetchaJS.LOADING_START){this.#b.loading&&(v==FetchaJS.LOADING_START?(this.#c.style.opacity=.4,document.querySelector("#fetchjs--loader").style.opacity=1):v==FetchaJS.LOADING_STOP&&(this.#c.style.opacity=1,document.querySelector("#fetchjs--loader").style.opacity=0))} #l(b){let Z=this,e={method:b.method},N=new FormData;"undefined"!==b.body&&"array"==typeof b.body&&(b.body.forEach(a=>{N.append(a[0],a[1])}),e.body=N),void 0!==b.headers&&(e.headers=b.headers),e=this.#q(e),fetch(b.url,{fetchConfig:e}).then(a=>{try{return a.json()}catch(c){Z.#r(b,c)}}).then(function(a){Z.#s(b,a)}).catch(function(a){Z.#r(b,a)})} #r(o,w){"undefined"!==o.error&&"function"==typeof o.error?(0,o.error)(w):console.log(w)} #s(x,y){let z=x.total;if("function"==typeof z)this.#b.pagination.total=z(y);else throw"FetchJS: server.total must be a function!";let A=x.then;if("function"==typeof A)this.#b.data=A(y);else throw"FetchJS: server.data must be a function!";this.#j()} #i(O){let $=this,P=this.#h;return Object.keys(O).forEach(function(a){P.hasOwnProperty(a)&&($.#g.includes(a)?Object.keys(O[a]).forEach(function(b){P[a][b]=O[a][b]}):P[a]=O[a])}),P} #t(B,Q,i){let C=1,D=null,E=[],F=0;this.#b.mode==FetchaJS.MODE_LOCAL&&(F=(this.getCurrentpage()-1)*i);for(let p=F;p<B.length;p++){let R=B[p];(void 0===i|| void 0!==i&&C<=parseInt(i))&&(D=Q,Object.keys(R).forEach(a=>{D.includes("{"+a+"}")&&(D=D.replace("{"+a+"}",R[a]))}),E.push(D),C++)}return E} #u(j){let d=[],f=j.buttonsCount,k=[],G=!1,l=Math.ceil(this.getTotal()/j.limit);this.#e=l;for(let q=1;q<=l;q++)k.push(q);if(f=f<1?1:f,l>f){G=!0;for(let H=f-1;H<l;H++){let S=parseInt(Math.floor(k.length/2));k.splice(S,1)}}if(d=k,j.prevButton&&d.unshift(this.#b.language.prevButton),j.nextButton&&d.push(this.#b.language.nextButton),G){let T=parseInt(Math.floor(d.length/2));d.splice(T,0,"...")}return d} #m(U,V,W,X){U.innerHTML=this.#t(V,W,X).join("")+this.#a} #n(a){let r=this.#u(a),I=[];a.activeClass=this.#p(a,"activeClass","fetchajs--active"),a.commonClass=this.#p(a,"commonClass","fetchajs--pagination-button"),a.current=this.#p(a,"current",1);for(let g=0;g<r.length;g++){let s=r[g],Y=s==a.current?a.activeClass:"",t=s;if(a.prevButton&&0==g&&(t=a.current-1<1?1:a.current-1),a.nextButton&&g==r.length-1){let J=parseInt(a.current)+1;t=J>this.#e?this.#e:J}I.push(`<button data-fetchajs-page="${t}" type="button"  class="${a.commonClass+" "+Y}">${s}</button>`)}a.position=FetchaJS.POSITION_ARRAY.includes(a.position)?a.position:this.#p(a,"position",FetchaJS.POSITION_BOTTOM_RIGHT);let K=`<div style="text-align: ${a.position.replace(/\b(?:top-|bottom-)\b/gi,"")}" class="fetchajs--pagination-block">${I.join("")}</div>`;this.#c.innerHTML=a.position.includes("top")?K+this.#c.innerHTML:this.#c.innerHTML+K,this.#v()} #v(){document.querySelectorAll(".fetchajs--pagination-block button").forEach(a=>{a.addEventListener("click",()=>{this.#b.pagination.current!=a.dataset.fetchajsPage&&this.setCurrentpage(a.dataset.fetchajsPage)})})}}